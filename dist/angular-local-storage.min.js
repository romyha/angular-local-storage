/**
 * An Angular module that gives you access to the browsers local storage
 * @version v0.7.1 - 2019-02-21
 * @link https://github.com/grevory/angular-local-storage
 * @author grevory <greg@gregpike.ca>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(e,t){var M=t.isDefined,w=t.isUndefined,x=t.isNumber,C=t.isObject,_=t.isArray,R=t.isString,I=t.extend,P=t.toJson;t.module("LocalStorageModule",[]).provider("localStorageService",function(){this.prefix="ls",this.storageType="localStorage",this.cookie={expiry:30,path:"/",secure:!1},this.defaultToCookie=!0,this.notify={setItem:!0,removeItem:!1},this.setPrefix=function(e){return this.prefix=e,this},this.setStorageType=function(e){return this.storageType=e,this},this.setDefaultToCookie=function(e){return this.defaultToCookie=!!e,this},this.setStorageCookie=function(e,t,o){return this.cookie.expiry=e,this.cookie.path=t,this.cookie.secure=o,this},this.setStorageCookieDomain=function(e){return this.cookie.domain=e,this},this.setNotify=function(e,t){return this.notify={setItem:e,removeItem:t},this},this.$get=["$rootScope","$window","$document","$parse","$timeout",function(s,i,u,a,o){var c,l=this,f=l.prefix,g=l.cookie,n=l.notify,d=l.storageType;u?u[0]&&(u=u[0]):u=document,"."!==f.substr(-1)&&(f=f?f+".":"");var h=function(e){return f+e},r=function(e){return e.replace(new RegExp("^"+f,"g"),"")},y=function(e){return 0===e.indexOf(f)},t=function(){try{var e=d in i&&null!==i[d],t=h("__"+Math.round(1e7*Math.random()));return e&&((c=i[d]).setItem(t,""),c.removeItem(t)),e}catch(e){return l.defaultToCookie&&(d="cookie"),s.$broadcast("LocalStorageModule.notification.error",e.message),!1}},T=t(),m=function(e,t,o){var r=$();try{if(E(o),t=w(t)?null:P(t),!T&&l.defaultToCookie||"cookie"===l.storageType)return T||s.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),n.setItem&&s.$broadcast("LocalStorageModule.notification.setitem",{key:e,newvalue:t,storageType:"cookie"}),k(e,t);try{c&&c.setItem(h(e),t),n.setItem&&s.$broadcast("LocalStorageModule.notification.setitem",{key:e,newvalue:t,storageType:l.storageType})}catch(e){throw s.$broadcast("LocalStorageModule.notification.error",e.message),e}return!0}finally{E(r)}},p=function(e,t){var o=$();try{if(E(t),!T&&l.defaultToCookie||"cookie"===l.storageType)return T||s.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),O(e);var r=c?c.getItem(h(e)):null;if(!r||"null"===r)return null;try{return JSON.parse(r)}catch(e){return r}}finally{E(o)}},v=function(){var e=$();try{var t,o,r=0;for(1<=arguments.length&&("localStorage"===arguments[arguments.length-1]||"sessionStorage"===arguments[arguments.length-1])&&(r=1,E(arguments[arguments.length-1])),t=0;t<arguments.length-r;t++)if(o=arguments[t],!T&&l.defaultToCookie||"cookie"===l.storageType)T||s.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),n.removeItem&&s.$broadcast("LocalStorageModule.notification.removeitem",{key:o,storageType:"cookie"}),b(o);else try{c.removeItem(h(o)),n.removeItem&&s.$broadcast("LocalStorageModule.notification.removeitem",{key:o,storageType:l.storageType})}catch(e){s.$broadcast("LocalStorageModule.notification.error",e.message),b(o)}}finally{E(e)}},S=function(){try{return i.navigator.cookieEnabled||"cookie"in u&&(0<u.cookie.length||-1<(u.cookie="test").indexOf.call(u.cookie,"test"))}catch(e){return s.$broadcast("LocalStorageModule.notification.error",e.message),!1}}(),k=function(e,t,o,r){if(w(t))return!1;if((_(t)||C(t))&&(t=P(t)),!S)return s.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;try{var n="",i=new Date,a="";if(null===t?(i.setTime(i.getTime()+-864e5),n="; expires="+i.toGMTString(),t=""):x(o)&&0!==o?(i.setTime(i.getTime()+24*o*60*60*1e3),n="; expires="+i.toGMTString()):0!==g.expiry&&(i.setTime(i.getTime()+24*g.expiry*60*60*1e3),n="; expires="+i.toGMTString()),e){var c="; path="+g.path;g.domain&&(a="; domain="+g.domain),"boolean"==typeof r?!0===r&&(a+="; secure"):!0===g.secure&&(a+="; secure"),u.cookie=h(e)+"="+encodeURIComponent(t)+n+c+a}}catch(e){return s.$broadcast("LocalStorageModule.notification.error",e.message),!1}return!0},O=function(e){if(!S)return s.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;for(var t=u.cookie&&u.cookie.split(";")||[],o=0;o<t.length;o++){for(var r=t[o];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(h(e)+"=")){var n=decodeURIComponent(r.substring(f.length+e.length+1,r.length));try{var i=JSON.parse(n);return"number"==typeof i?n:i}catch(e){return n}}}return null},b=function(e){k(e,null)},L=function(){for(var e=null,t=f.length,o=u.cookie.split(";"),r=0;r<o.length;r++){for(e=o[r];" "===e.charAt(0);)e=e.substring(1,e.length);var n=e.substring(t,e.indexOf("="));b(n)}},$=function(){return d},E=function(e){return e&&d!==e&&(d=e,T=t()),T};function e(e){if(e||(e=i.event),n.setItem&&R(e.key)&&y(e.key)){var t=r(e.key);o(function(){s.$broadcast("LocalStorageModule.notification.changed",{key:t,newvalue:e.newValue,storageType:l.storageType})})}}T&&(i.addEventListener?(i.addEventListener("storage",e,!1),s.$on("$destroy",function(){i.removeEventListener("storage",e)})):i.attachEvent&&(i.attachEvent("onstorage",e),s.$on("$destroy",function(){i.detachEvent("onstorage",e)})));return{isSupported:T,getStorageType:$,setStorageType:E,setPrefix:function(e){f=e},set:m,add:m,get:p,keys:function(e){var t=$();try{if(E(e),!T)return s.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),[];var o=f.length,r=[];for(var n in c)if(n.substr(0,o)===f)try{r.push(n.substr(o))}catch(e){return s.$broadcast("LocalStorageModule.notification.error",e.Description),[]}return r}finally{E(t)}},remove:v,clearAll:function(e,t){var o=$();try{E(t);var r=f?new RegExp("^"+f):new RegExp,n=e?new RegExp(e):new RegExp;if(!T&&l.defaultToCookie||"cookie"===l.storageType)return T||s.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),L();if(!T&&!l.defaultToCookie)return!1;var i=f.length;for(var a in c)if(r.test(a)&&n.test(a.substr(i)))try{v(a.substr(i))}catch(e){return s.$broadcast("LocalStorageModule.notification.error",e.message),L()}return!0}finally{E(o)}},bind:function(e,t,o,r,n){var i=p(r=r||t,n);return null===i&&M(o)?i=o:C(i)&&C(o)&&(i=I(i,o)),a(t).assign(e,i),e.$watch(t,function(e){m(r,e,n)},C(e[t]))},deriveKey:h,underiveKey:r,length:function(e){var t=$();try{E(e);for(var o=0,r=i[d],n=0;n<r.length;n++)0===r.key(n).indexOf(f)&&o++;return o}finally{E(t)}},defaultToCookie:this.defaultToCookie,cookie:{isSupported:S,set:k,add:k,get:O,remove:b,clearAll:L}}}]})}(window,window.angular);
//# sourceMappingURL=angular-local-storage.min.js.map